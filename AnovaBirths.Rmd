---
title: "ANOVA"
author: "Michał Kędra"
output: html_document
---

```{r, warning=FALSE, echo =FALSE, message =FALSE  }
library(ggplot2)
library(psych)     
library(lawstat)   
library(dunn.test)
library(tseries)
library(readxl)

```

### Introduction
ANOVA is a technique used to analise the differences among group means in a sample. For example, with ANOVA we can group people by age and see if mean of iq within all groups is equal. The null hypothesis for ANOVA is that all population means are exactly equal.

we will check if birth weight is affected by age of the mother and race. Birth weight is the body weight of a baby at its birth. The average birth weight in babies of European heritage is 3.5 kilograms. But to begin, let's see, how data looks.


### Seeing data


```{r}
births<-read_excel("births.xls")
tail(births)

```
As we can see we have many variables in data set, but we will focus on belove described ones:

* __BWT__ - birth weight in grams
* __AGE__ -  mother age, when baby was borned
* __RACE__ - skin color (1 = white, 2 = black, 3 = other)



```{r}
str(births)
```

```{r}
births$AGE[births$AGE < 23]<- 0
births$AGE[births$AGE >= 23 ]<- 1
```



```{r}
births$RACE<- factor(births$RACE, labels = c("white", "black", "other"))
births$AGE<- factor(births$AGE, labels = c("0-23", "23+"))
```


```{r}
ggplot(births)+ geom_boxplot(aes(births$RACE, births$BWT, color= births$RACE))
```

```{r, echo =FALSE}
ggplot(births)+ geom_boxplot(aes(births$AGE, births$BWT, color= births$AGE))
ggplot(births)+ geom_boxplot(aes(births$RACE, births$BWT, color= births$AGE))

```



```{r}
describeBy(births$BWT, births$RACE, mat = TRUE)
describeBy(births$BWT, births$AGE, mat = TRUE)
```

```{r}
shapiro_pvalue<-function (x){
  return (shapiro.test(x)$p.value)
}
tapply(births$BWT, births[,c(1,3)], shapiro_pvalue)

```


```{r}
births_anova <- aov(BWT~AGE*RACE, data = births)
summary(births_anova)
```


